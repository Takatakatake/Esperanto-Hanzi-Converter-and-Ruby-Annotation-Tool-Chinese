# 世界语汉字转换与注释工具使用说明书

## 目录
1. 应用概述
2. 主程序使用方法
3. JSON生成工具使用方法
4. 高级功能与技巧
5. 常见问题解答

## 1. 应用概述

本应用是一个世界语(Esperanto)文本处理工具，主要功能包括：

- 将世界语文本转换为带有汉字注释的形式（使用Ruby标注）
- 直接用汉字替换世界语词根
- 生成格式化的HTML或带括号的文本
- 自定义替换规则和词根解析方式

应用包含两个主要部分：
- **主程序**：执行世界语文本的转换和注释
- **JSON生成工具**：创建和自定义转换规则文件

## 2. 主程序使用方法

### 2.1 基本使用流程

1. **选择替换规则JSON文件**
   - 选择"使用默认JSON"或"上传JSON文件"
   - 如需自定义替换规则，可先使用JSON生成工具创建规则文件

2. **配置并行处理选项（可选）**
   - 如需处理大型文本，可启用"使用并行处理"
   - 根据您的计算机性能，设置适当的并行进程数（2-4）

3. **选择输出格式**
   - HTML格式_Ruby文字_大小调整：生成带有自适应大小Ruby注释的HTML
   - HTML格式_Ruby文字_大小调整_汉字替换：将世界语替换为汉字，原文作为注释
   - HTML格式：简单Ruby注释，无大小调整
   - HTML格式_汉字替换：简单汉字替换，原文作为注释
   - 括弧(号)格式：使用括号标注对应汉字，如"esperanto(世界语)"
   - 括弧(号)格式_汉字替换：使用括号标注原世界语，如"世界语(esperanto)"
   - 替换后文字列のみ(仅)保留：仅保留汉字，完全替换世界语

4. **输入世界语文本**
   - 可以选择"手动输入"或"上传文件"
   - 上传文件需为UTF-8编码的文本文件

5. **选择世界语字母形式**
   - 上标形式：使用带音调符号的字母（ĉ, ĝ, ĥ等）
   - x形式：使用x后缀（cx, gx, hx等）
   - ^形式：使用^后缀（c^, g^, h^等）

6. **提交并查看结果**
   - 转换结果将显示在页面底部
   - 如为HTML格式，可以选择查看渲染效果或HTML源码
   - 可通过下载按钮获取完整结果

### 2.2 特殊文本标记

在输入文本时，可以使用以下特殊标记：

- **%文本%**：被标记的文本将**跳过替换**，保持原样
  例如：`La %hundo% kuras.` 中的"hundo"将不被替换

- **@文本@**：被标记的文本将**只做局部替换**，使用特定的局部替换列表
  例如：`La @hundo@ kuras.` 中的"hundo"将使用局部替换规则

## 3. JSON生成工具使用方法

### 3.1 基本使用流程

1. **选择输出格式**
   - 根据需求选择与主程序相同的输出格式选项

2. **准备CSV文件**
   - 选择"上传CSV"或"使用默认CSV"
   - CSV文件应包含两列：[世界语词根, 汉字/中文含义]
   - 文件需为UTF-8编码

3. **准备词根分解法/自定义替换JSON文件**
   - 选择"上传JSON"或"使用默认JSON"
   - 词根分解法JSON：定义词根如何解析，自动添加词尾等
   - 自定义替换后文字JSON：定义特殊词的特殊汉字替换规则

4. **配置并行处理选项（可选）**
   - 对于大规模替换JSON，可启用并行处理加快生成速度
   - 设置适当的CPU进程数（2-6）

5. **生成并下载JSON文件**
   - 点击"生成并下载替换用JSON文件"按钮
   - 生成过程可能需要几分钟，请耐心等待
   - 生成完成后，可下载合并的JSON文件，用于主程序中使用

### 3.2 示例文件

在页面中提供了多个示例文件，可以下载参考：

- **示例CSV**：包含世界语词根-中文对应表、汉字对应表等
- **示例JSON**：包含词根分解方法设置、自定义替换规则等
- **示例Excel**：提供带有词义和掌握等级的参考数据

## 4. 高级功能与技巧

### 4.1 自定义词根分解

通过词根分解法JSON文件，您可以：

- 指定某些词是否为动词，并自动添加动词变化词尾(as, is, os等)
- 设置形容词和副词的处理方式
- 自定义特殊后缀(如an, on)的解析方式
- 调整替换优先级，解决替换冲突

### 4.2 Ruby文字大小调整

使用"HTML格式_Ruby文字_大小调整"选项时，系统会根据汉字和世界语文本的相对宽度：

- 自动调整Ruby文字的大小
- 对过长的注释自动插入换行
- 优化显示效果，使注释清晰易读

### 4.3 并行处理大型文本

处理大型文本时，建议：

- 启用并行处理选项
- 根据计算机性能设置合适的进程数（通常2-4为佳）
- 预留足够的内存，特别是处理大文件时

## 5. 常见问题解答

### 5.1 文件格式问题

**Q: 为什么上传的CSV文件无法正确读取？**  
A: 请确保CSV文件使用UTF-8编码，并且包含两列数据（世界语词根和对应的汉字/中文）。

**Q: 上传的JSON文件格式有什么要求？**  
A: JSON文件需正确格式化，建议先下载示例文件了解结构，然后根据需要修改。

### 5.2 替换效果问题

**Q: 为什么某些世界语单词没有被替换？**  
A: 可能是因为：
- 该词根不在替换列表中
- 单词被%...%标记排除
- 替换规则JSON中未包含该词的处理规则

**Q: Ruby注释显示不正确怎么办？**  
A: 确保选择了正确的输出格式，并在浏览器中正确查看HTML结果。某些浏览器可能对Ruby标签支持有限。

### 5.3 性能问题

**Q: 生成JSON文件时非常慢怎么办？**  
A: 启用并行处理选项，并适当增加进程数。生成大型JSON文件确实需要时间，特别是自定义规则复杂时。

**Q: 转换大文本时应用崩溃怎么办？**  
A: 尝试分段处理文本，或增加服务器内存。对于特别大的文件，可以考虑分批处理。

---

希望本使用说明能帮助您充分利用世界语汉字转换与注释工具。如需更多信息，请访问GitHub代码库：
https://github.com/Takatakatake/Esperanto-Hanzi-Converter-and-Ruby-Annotation-Tool-Chinese